/*
 * Linkes Differential Scrolling - jQuery Plugin
 * Simple differential scrolling for your websites
 *
 * Examples and documentation at: http://davelinke.tumblr.com/post/32463586345/differential-scrolling-jquery-plugin
 *
 * Copyright (c) 2012 David Linke
 *
 * Version: 1.0 (09/28/2012)
 * Requires: jQuery v1.6+
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
 (function($){$.fn.linkesDiffScroll=function(q){if(typeof(q)=='undefined'){q=function(){}}var r=this;if(r.length>0){r.each(function(){$(this).data('a',{});var a=$(this).data('a');a.wrapper=$(this);a.scrollFlag=0});$.fn.linkesDiffScroll.initialize=function(b){b.each(function(){var a=$(this).data('a');a.scrollStartPosition=$(document).scrollTop();a.diffWrapperOffsetTop=a.wrapper.offset().top;a.divsToScroll=[];a.scrolltime=-1})};$.fn.linkesDiffScroll.setParameters=function(e){e.each(function(){var d=$(this).data('a');d.vpHeight=$(window).height();d.wrapperHeight=d.wrapper.height();d.divsToScroll.length=0;d.wrapper.each(function(){$(this).children('div').each(function(n){var a=$(this).parent().data('a');$(this).css('height','');$(this).css('min-height','');$(this).css('position','relative');var b=$(this).height();if(b<a.wrapperHeight){$(this).height(a.wrapperHeight);if($(this).find('.l_dsd').length<1){$(this).wrapInner('<div class="l_dsd" />')}var c=$(this).find('.l_dsd');c.css('min-height',a.vpHeight+'px');c.width($(this).width());a.divsToScroll.push($(this))}})})})};$.fn.linkesDiffScroll.scrollFunction=function(p){p.each(function(){var a=$(this).data('a');var b=a.wrapper.offset().top;var c=b+a.wrapperHeight-a.vpHeight;var d=$(document).scrollTop();if(d<b){for(var i=0;i<a.divsToScroll.length;i++){a.divsToScroll[i].find('.l_dsd').css('top','0px').css('position','relative')}}else if(d>c){for(var i=0;i<a.divsToScroll.length;i++){var e=a.divsToScroll[i];e.find('.l_dsd').css('top','').css('bottom','0').css('position','absolute')}}else{for(var i=0;i<a.divsToScroll.length;i++){var e=a.divsToScroll[i];var f=e.find('.l_dsd');var g=f.height();var h=f.position().top;var j=a.wrapperHeight-g-h;if((a.diffWrapperOffsetTop+g)<a.vpHeight){f.height(a.vpHeight);g=f.height();j=a.wrapperHeight-g-h}if(d>a.scrollStartPosition){var k=parseInt(f.css('top').replace('px',''));var l=f.css('position');if(l=='fixed'){if(f.attr('sf')!='1'){var m=d-a.diffWrapperOffsetTop;f.css('top',m+'px').css('position','relative')}}else{var n=a.diffWrapperOffsetTop+g+k-a.vpHeight;if(d>n){f.css('top','').css('position','fixed').css('bottom','0').attr('sf','1')}}}else if(d==a.scrollStartPosition){}else{var l=f.css('position');if(l=='fixed'){var k=parseInt(f.css('top').replace('px',''));if(k!=0){var m=(d-a.diffWrapperOffsetTop)-(f.height()-a.vpHeight);f.css('top',m+'px').css('position','relative').attr('sf','0')}}else if(l=='absolute'){f.css('top',(a.wrapperHeight-f.height())+'px').css('position','relative').css('bottom','').attr('sf','0')}else if(l=='relative'){var k=parseInt(f.css('top').replace('px',''));if(k>0){var o=k+a.diffWrapperOffsetTop;if(d<o){f.css('top','0px').css('position','fixed').css('bottom','')}}}}}}a.scrollStartPosition=d})};$.fn.linkesDiffScroll.initialize(r);$.fn.linkesDiffScroll.setParameters(r);$(window).bind('scroll',function(){$.fn.linkesDiffScroll.scrollFunction(r)});$(window).bind('resize',function(){$.fn.linkesDiffScroll.setParameters(r);$.fn.linkesDiffScroll.scrollFunction(r)})}q()}})(jQuery);